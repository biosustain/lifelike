# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/config-gitpod-file)
# and commit this file to your remote git repository to share the goodness with others.

tasks:
  - name: Angular frontend
    before: cd client
    init: yarn install
    command: yarn run dev-start
    openIn: right

  - name: services
    init: docker-compose -f docker-compose.services.yml pull
    command: docker-compose -f docker-compose.services.yml up -d

  - name: appserver
    before: cd appserver
    init: pipenv install --dev --keep-outdated
    command: pipenv run flask run
    env:
      FLASK_APP: app.py
      FLASK_ENV: development

  - name: SE service
    before: cd appserver
    init: pipenv install --dev --keep-outdated
    command: pipenv run flask run
    env:
      FLASK_APP: app.py
      FLASK_ENV: development

  - name: Access Developer assets
    init: gcloud init

  - name: Download LMDB data files
    before: |
      gsutil cp gs://lmdb/public/lmdb_v6.tgz .
      tar zxfg lmdb.tgz

ports:
  - port: 4200
    name: client
    description: Angular Live Development Server
    visibility: public
    onOpen: open-preview

  - port: 5000
    name: appserver
    description: Flask development server
    visibility: public
    onOpen: ignore

  - port: 7601
    name: pdfparse
    description: PDF Parser service
    visibility: public
    onOpen: ignore

  - port: 5432
    name: postgres
    description: PostgresQL database
    visibility: public
    onOpen: ignore

  - port: 9200
    name: elasticsearch
    description: Elasticsearch service
    visibility: public
    onOpen: ignore

  - port: 7474
    name: neo4j-browser
    description: Neo4j browser UI
    visibility: public
    onOpen: notify

  - port: 8768
    name: neo4j-bolt
    description: Neo4j Bolt port
    visibility: public
    onOpen: ignore

  - port: 5010
    name: statistical-enrichment
    description: Statistical Enrichment service app
    visibility: public
    onOpen: ignore

image:
  file: .gitpod.Dockerfile

vscode:
  extensions:
    - ms-python.python
    - donjayamanne.python-extension-pack
    - almenon.arepl
    - esbenp.prettier-vscode
    - dbaeumer.vscode-eslint
    - mgesbert.python-path
    - christian-kohler.path-intellisense
    - DavidAnson.vscode-markdownlint

gitConfig:
  diff.ignoreSubmodules: all
