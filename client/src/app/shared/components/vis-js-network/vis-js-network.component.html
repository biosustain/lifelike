<div
  *ngIf="!stabilized; else stable"
  class="h-100 w-100 d-flex justify-content-center align-items-center"
>
  <i class="fa fa-spinner fa-spin fa-3x text-primary"></i>
</div>
<ng-template #stable>
  <div class="overlay-container top navigation">
    <app-legend [legend]="legend"></app-legend>
    <app-search-control
      (next)="findNext()"
      (ngModelChange)="searchQueryChanged()"
      (previous)="findPrevious()"
      [(ngModel)]="searchQuery"
      [resultCount]="searchResults.length"
      [resultIndex]="currentSearchIndex"
      class="search"
    >
    </app-search-control>
    <div class="d-flex zoom">
      <button
        (click)="fitToNetwork()"
        class="btn btn-secondary border-white"
        container="body"
        ngbTooltip="Fit Canvas"
        placement="bottom right left top"
      >
        <i class="fas fa-fw fa-expand-arrows-alt"></i>
      </button>
      <button
        (click)="zoomIn()"
        class="btn btn-secondary border-white"
        container="body"
        ngbTooltip="Zoom In"
        placement="bottom right left top"
      >
        <i class="fa fa-fw fa-search-plus"></i>
      </button>
      <button
        (click)="zoomOut()"
        class="btn btn-secondary border-white"
        container="body"
        ngbTooltip="Zoom Out"
        placement="bottom right left top"
      >
        <i class="fa fa-fw fa-search-minus"></i>
      </button>
    </div>
  </div>
  <div class="overlay-container bottom utilities">
    <app-collapsible-window [reversed]="true" class="options" title="Network Layout Options">
      <div class="window-body">
        <form>
          <div class="form-group">
            <div class="custom-control custom-checkbox my-1 mr-sm-2">
              <input
                (click)="togglePhysics()"
                [checked]="physicsEnabled"
                [id]="networkContainerId + '-physics-enabled-checkbox'"
                class="custom-control-input"
                type="checkbox"
              />
              <label
                [for]="networkContainerId + '-physics-enabled-checkbox'"
                class="custom-control-label"
                >Physics enabled</label
              >
            </div>
          </div>
          <div class="form-group">
            <label class="my-1 mr-2">Layout Strategy:</label>
            <select
              (change)="updateNetworkLayout($event.target.value)"
              [value]="currentSolver"
              class="custom-select"
            >
              <option *ngFor="let solver of solverMap | keyvalue" [value]="solver.key">
                {{ solver.value }}
              </option>
            </select>
          </div>
          <div class="form-group">
            <label class="my-1 mr-2">Edge Smoothing:</label>
            <select
              (change)="updateNetworkEdgeSmooth($event.target.value)"
              [value]="currentSmooth"
              class="custom-select"
            >
              <option *ngFor="let smooth of smoothMap | keyvalue" [value]="smooth.key">
                {{ smooth.value }}
              </option>
            </select>
          </div>
          <div class="form-group">
            <label [for]="networkContainerId + '-central-gravity'"
              >Central Gravity: {{ currentCentralGravity }}</label
            >
            <input
              (change)="updateNetworkCentralGravity($event.target.value)"
              [id]="networkContainerId + '-central-gravity'"
              [value]="currentCentralGravity"
              class="custom-range"
              max="1"
              min="0"
              step="0.10"
              type="range"
            />
          </div>
        </form>
      </div>
    </app-collapsible-window>
    <app-collapsible-window
      *ngIf="(selected | async)?.edges?.length"
      [reversed]="true"
      class="selection"
      title="Selection"
    >
      <div class="window-body" style="max-height: 80vh">
        <ng-container *ngTemplateOutlet="selection; context: selected | async"></ng-container>
      </div>
    </app-collapsible-window>
  </div>
</ng-template>
<div
  [id]="networkContainerId"
  class="h-100 w-100"
  [ngStyle]="{
    display: stabilized ? 'block' : 'hidden',
    cursor: cursorStyle
  }"
></div>
