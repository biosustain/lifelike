<ng-container
  *ngIf="
    showOpen ||
    (object.privileges.writable && (object.isEditable || object.isAnnotatable)) ||
    object.isVersioned
  "
>
  <button
    ngbDropdownItem
    (click)="this.objectOpen.next(object)"
    [disabled]="!object.isOpenable"
    *ngIf="showOpen"
  >
    Open
  </button>
  <ng-container *ngIf="object.privileges.writable">
    <button ngbDropdownItem (click)="openEditDialog(object)" *ngIf="object.isEditable">
      Edit {{ nameEntity && object.isDirectory ? 'folder' : 'details' }}...
    </button>
    <button ngbDropdownItem (click)="reannotate([object])" *ngIf="object.isAnnotatable">
      Re-annotate
    </button>
  </ng-container>
  <ng-container *ngIf="object.isVersioned">
    <button ngbDropdownItem (click)="openVersionHistoryDialog(object)" *ngIf="!showRestore">
      Version history...
    </button>
    <button ngbDropdownItem (click)="openVersionRestoreDialog(object)" *ngIf="showRestore">
      Restore from history...
    </button>
  </ng-container>
  <div class="dropdown-divider"></div>
</ng-container>

<ng-container
  *ngIf="
    object.isCloneable ||
    (object.privileges.writable && (object.isMovable || object.isDeletable)) ||
    (object.parent.isProjectRoot && object.project.isPublication)
  "
>
  <button ngbDropdownItem (click)="openCloneDialog(object)" *ngIf="object.isCloneable">
    Copy{{ nameEntity && object.isDirectory ? ' folder' : '' }} to...
  </button>
  <ng-container *ngIf="object.privileges.writable && forEditing">
    <button ngbDropdownItem (click)="openMoveDialog([object])" [disabled]="!object.isMovable">
      Move{{ nameEntity && object.isDirectory ? ' folder' : '' }} to...
    </button>
  </ng-container>
  <ng-container
    *ngIf="
      !nameEntity &&
      (object.privileges.writable ||
        (object.parent.isProjectRoot && object.project.isPublication)) &&
      showDelete
    "
  >
    <button ngbDropdownItem (click)="openDeleteDialog([object])" [disabled]="!object.isDeletable">
      Delete...
    </button>
  </ng-container>
  <div class="dropdown-divider"></div>
</ng-container>

<ng-container>
  <app-exporters-ref [object]="object">
    <ng-template let-action let-label="label">
      <button ngbDropdownItem (click)="action()">{{ label }}</button>
    </ng-template>
  </app-exporters-ref>
  <button ngbDropdownItem (click)="openShareDialog(object)">
    Copy{{ nameEntity && object.isDirectory ? ' folder' : '' }} link...
  </button>
  <button *ngIf="object.uploadUrl" ngbDropdownItem (click)="openLink(object.uploadUrl)">
    Open external URL...
  </button>
  <button *ngIf="object.doi" ngbDropdownItem (click)="openLink(object.doi)">Open DOI...</button>
  <button ngbDropdownItem (click)="updateStarred(object.hashId, !object.starred)">
    {{ object.starred ? 'Remove from' : 'Add to' }} starred
  </button>
  <button *ngIf="object.privileges?.writable" ngbDropdownItem (click)="updatePinned(object)">
    {{ object.pinned ? 'Unpin' : 'Pin' }}
  </button>
  <ng-container *ngIf="object.isNavigable">
    <button
      ngbDropdownItem
      [appLink]="['/file-navigator', encodeURIComponent(object.project.name), object.hashId]"
      [parentAddress]="router.url"
      [newTab]="true"
      [forceWorkbench]="true"
      [sideBySide]="true"
      [openParentFirst]="true"
    >
      Open file navigator
    </button>
  </ng-container>
</ng-container>
