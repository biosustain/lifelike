<div
  fxLayout="column"
  fxLayoutGap="30px"
>
  <div>
    <div>Preview of Uploaded Worksheet</div>
    <mat-table [dataSource]="chosenSheetToMap?.sheetPreview">
      <mat-header-row *matHeaderRowDef="columnsForFilePreview"></mat-header-row>
      <mat-row *matRowDef="let row; let i=index; columns: columnsForFilePreview;" [attr.id]="'file-preview-row-'+i"></mat-row>

      <ng-container *ngFor="let col of columnsForFilePreview" [matColumnDef]="col">
        <mat-header-cell *matHeaderCellDef>{{ col }}</mat-header-cell>
        <mat-cell *matCellDef="let i=index;">{{ chosenSheetToMap?.sheetPreview[i][col] }}</mat-cell>
      </ng-container>
    </mat-table>
  </div>

  <div>
    <div>Name the domain this worksheet will represent. Usually just the name of the worksheet and filename; e.g AMR_filename.</div>
    <mat-form-field>
      <input
        matInput
        type="text"
        [(ngModel)]="worksheetDomain"
      />
    </mat-form-field>
  </div>

  <div>
    <div>Add Column Mapping</div>
    <div>
      <button
        mat-stroked-button
        type="button"
        color="accent"
        (click)="addColumnMappingRow()"
      >Add Mapping Row</button>
    </div>
  </div>

  <div [formGroup]="columnMappingForm">
    <div formArrayName="columnMapping">
      <div *ngFor="let row of columnMappingForm.get('columnMapping').controls; let i=index">
        <div [formGroupName]="i">
          <app-import-column-mapping-row
            [columnHeaders]="chosenSheetToMap?.sheetColumnNames"
            [columnMappingForm]="columnMappingForm.get('columnMapping').controls[i]"
            [relationshipTypes]="dbRelationshipTypes$ | async"
            [existingNodeLabels]="dbNodeTypes$ | async"
            [existingNodeProperties]="dbNodeProperties$ | async"
            (deleteMapping)="deleteMappingRow(i)"
          ></app-import-column-mapping-row>
        </div>
      </div>
    </div>
  </div>

  <div>
    <div>Add Node Property Mapping</div>
    <div>
      <button
        mat-stroked-button
        type="button"
        color="accent"
        (click)="addNodePropertyMappingRow()"
      >Add Node Property Mapping Row</button>
    </div>
  </div>

  <div [formGroup]="nodePropertyMappingForm">
    <div formArrayName="nodePropertyMapping">
      <div *ngFor="let row of nodePropertyMappingForm.get('nodePropertyMapping').controls; let i=index">
        <div [formGroupName]="i">
          <app-import-column-node-property-mapping-row
            [columnHeaders]="chosenSheetToMap?.sheetColumnNames"
            [nodePropertyMappingForm]="nodePropertyMappingForm.get('nodePropertyMapping').controls[i]"
            (deleteMapping)="deleteColumnNodePropertyMappingRow(i)"
          ></app-import-column-node-property-mapping-row>
        </div>
      </div>
    </div>
  </div>

  <div>
    <button
      mat-stroked-button
      type="button"
      (click)="createNodeMappings()"
    >Next</button>
  </div>
</div>
