<div *ngIf="legendLabels" id="settings-container" class="floating-toolbar" [ngClass]="navbarCollapsed ? 'unexpanded' : 'expanded'">
  <div
    id="canvas-settings-button"
    (click)="navbarCollapsed = !navbarCollapsed"
    [attr.aria-expanded]="!navbarCollapsed"
    aria-controls="navbarContent"
    aria-expanded="false"
    aria-label="Toggle settings">
    <mat-icon>settings</mat-icon>
  </div>
  <div id="settings-content" [ngClass]="navbarCollapsed ? 'unexpanded' : 'expanded'">
    <form [formGroup]="settingsForm" class="d-flex flex-column justify-content-between">

      <!-- Animation toggle -->
      <div class="custom-control custom-switch">
        <input type="checkbox" formControlName="animation" class="custom-control-input" id="animation-toggle">
        <label class="custom-control-label" for="animation-toggle">Animation</label>
      </div>

      <!-- Max cluster rows input -->
      <label class="mt-2" for="max-cluster-rows-input">Max rows shown in clusters:</label>
      <input
        id="max-cluster-rows-input"
        [ngClass]="'form-control w-50' + (settingsForm.get('maxClusterShownRows').invalid ? ' invalid-input' : '')"
        type="number"
        step="1"
        formControlName="maxClusterShownRows"
        name="firstName"
      />
      <div class="invalid-msg" *ngIf="settingsForm.get('maxClusterShownRows').hasError('required')">
        Max rows cannot be empty!
      </div>
      <div class="invalid-msg" *ngIf="settingsForm.get('maxClusterShownRows').hasError('min')">
        Max rows cannot be less than 1!
      </div>
      <div class="invalid-msg" *ngIf="settingsForm.get('maxClusterShownRows').hasError('pattern')">
        Max rows must be a whole number!
      </div>

      <!-- Labels to include in expand result checkboxes -->
      <label class="mt-2">Include in Expanded Nodes:</label>
      <div
        class="custom-control custom-checkbox"
        *ngFor="let label of legendLabels; index as i"
      >
        <input type="checkbox" [formControlName]="label" class="custom-control-input" [id]="'legend-label-' + i">
        <label class="custom-control-label" [for]="'legend-label-' + i">{{ label }}</label>
      </div>
    </form>
  </div>
</div>
