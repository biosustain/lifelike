<!-- According to the Angular Material docs (https://material.angular.io/components/sidenav/api#MatSidenavContainer),
we should be careful using 'autosize', as it may lead to performance problems.-->
<mat-sidenav-container autosize="true" fxFlexFill>
  <mat-sidenav-content class="sidenav-content" fxFlexFill>
    <app-visualization-quickbar (animationStatus)="toggleAnimation($event)"></app-visualization-quickbar>

    <app-legend [legend]="legend"></app-legend>

    <app-visualization-settings
      [legendLabels]="legendLabels"
      (settingsFormChanges)="updateSettings($event)"
    ></app-visualization-settings>

    <div id="network-viz"></div>

    <!-- This isn't visible unless the user has right-clicked to open the context menu -->
    <app-context-menu
      [tooltipSelector]="contextMenuTooltipSelector"
      [tooltipOptions]="contextMenuTooltipOptions"
      [selectedNodeIds]="selectedNodes"
      [selectedEdgeIds]="selectedEdges"
      [selectedNodeEdgeLabelData]="selectedNodeEdgeLabelData"
      [selectedClusterNodeData]="selectedClusterNodeData"
      (groupNeighborsWithRelationship)="groupNeighborsWithRelationship($event)"
      (removeNodes)="removeNodes($event)"
      (removeEdges)="removeEdges($event)"
      (selectNeighbors)="selectNeighbors($event)"
      (pullOutNodeFromCluster)="removeNodeFromCluster($event)"
    ></app-context-menu>
    <button id="sidenav-toggle-button" mat-mini-fab (click)="toggleSidenavOpened()">
      <mat-icon *ngIf="sidenavOpened">chevron_right</mat-icon>
      <mat-icon *ngIf="!sidenavOpened">chevron_left</mat-icon>
    </button>
  </mat-sidenav-content>

  <mat-sidenav class="sidenav" #sidenav position="end" mode="over" [(opened)]="sidenavOpened" (openedChange)="setSidenavStatus($event)">
    <div id="mat-sidenav-container">
      <!-- Each switch case appears to be lazy loaded, so switching between two cases will destroy the old case, and create the new case. -->
      <div [ngSwitch]="sidenavEntityType">
        <div *ngSwitchCase="sidenavEntityTypeEnum.NODE">
          <app-sidenav-node-view [nodeEntity]="sidenavEntity"></app-sidenav-node-view>
        </div>
        <div *ngSwitchCase="sidenavEntityTypeEnum.EDGE">
          <app-sidenav-edge-view
            [edgeEntity]="sidenavEntity"
            [isNewEntity]="isNewEdgeSidenavEntity"
            [legend]="legend"
            (requestNewPageEmitter)="requestNewEdgeSnippetsPage($event)"
          ></app-sidenav-edge-view>
        </div>
        <div *ngSwitchCase="sidenavEntityTypeEnum.CLUSTER">
          <app-sidenav-cluster-view
            [clusterEntity]="sidenavEntity"
            [isNewEntity]="isNewClusterSidenavEntity"
            [legend]="legend"
            (requestNewPageEmitter)="requestNewClusterSnippetsPage($event)"
          ></app-sidenav-cluster-view>
        </div>
        <div *ngSwitchCase="sidenavEntityTypeEnum.EMPTY">
          <h1>Canvas Data View</h1>
          <h4>(Select something on the canvas to see some data!)</h4>
        </div>
      </div>
    </div>
  </mat-sidenav>
</mat-sidenav-container>
