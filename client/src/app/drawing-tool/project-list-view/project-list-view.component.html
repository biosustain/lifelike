<div id='map-channel' fxFlex fxLayout class='w-100 vh-100'>
  <!-- Map List -->
  <div *ngIf='fullScreenmode==="shrink"' id='map-list-container' class='h-100' fxFlex="30">
    <app-map-list
      childMode='true'
      [projects]='projects'
      [publicProjects]='publicProjects'
      (projectAPICaller)='handleAPI($event)'
      [displayIndex]='displayIndex'>
    </app-map-list>
    <button
      mat-fab
      color='primary'
      id='add-project'
      aria-label="Example icon-button with a heart icon"
      (click)='createProject()'>
      <mat-icon>add</mat-icon>
    </button>
    <button
      mat-fab
      color='primary'
      id='upload-project'
      (click)='uploadProject()'
    >
      <mat-icon>cloud_upload</mat-icon>
    </button>
    <button
      mat-fab
      color='primary'
      id='search'
      aria-label="Example icon-button with a heart icon"
      (click)='goToSearch()'>
      <mat-icon>search</mat-icon>
    </button>
  </div>
  <div *ngIf='selectedProject else empty;' class='h-100' fxFill [fxFlex]="fullScreenmode === 'shrink' ? 70 : 100" fxLayout='column' fxLayoutAlign="start center">
    <!-- Map Preview Panel -->
    <div class='bg-green' fxFill [fxFlex]="fullScreenmode === 'shrink' ? 70 : 100" fxLayoutAlign="center center">
      <div
        fxFill
        id='map-preview'>
        <div
          id='canvas-container'>
          <app-map-preview
            [project]='selectedProject'
            (toggleFullscreen)='toggleFullscreen($event)'>
          </app-map-preview>
        </div>
      </div>
    </div>
    <!-- Map Meta Panel -->
    <div *ngIf='fullScreenmode==="shrink"' id='map-meta-panel' fxFill fxFlex="30" fxLayout='row'>
      <!-- Meta Info -->
      <div id='details' fxFill fxFlex="70">
        <h2>{{selectedProject?.label}}</h2>
        <p class='author'>
          By {{selectedProject?.author}}
        </p>
        <p class='date'>
          Modified {{selectedProject?.date_modified | friendlyDateStr}}
        </p>
        <p class='description'>
          {{selectedProject?.description}}
        </p>
      </div>
      <!-- Actions -->
      <div id='actions' fxFill fxFlex="30" fxLayout='column' fxLayoutAlign="center center">
        <div *ngIf='isItMine'>
          <button
            mat-raised-button
            color="primary"
            (click)='goToProject()'>
            EDIT
          </button>
          <button
            mat-raised-button
            [color]="selectedProject?.public === false ? 'primary' : 'accent'"
            (click)='togglePublic()'>
            {{selectedProject?.public === false ? 'MAKE PUBLIC' : 'MAKE PRIVATE'}}
          </button>
          <button
            mat-raised-button
            color="warn"
            (click)='deleteProject()'>
            DELETE
          </button>
          <button
            mat-raised-button
            color="accent"
            (click)='downloadProject()'>
            DOWNLOAD
          </button>
        </div>
        <div *ngIf='!isItMine'>
          <button
            mat-raised-button
            color="primary"
            (click)='copyProject()'>
            MAKE COPY OF
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Empty Scene -->
<ng-template #empty>
  <div fxFill fxLayout='column' fxLayoutAlign="center center" class='empty h-100'>
    <p>Create or select a map</p>
  </div>
</ng-template>
