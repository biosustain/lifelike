<div class="d-flex flex-column position-relative h-100" *ngIf="(loadTask.status$ | async) as status">
    <app-module-progress *ngIf="status.running" class="position-absolute w-100 h-100 bg-white p-4"
                         style="z-index: 2">
        <div>
            Downloading file...
        </div>
    </app-module-progress>

    <app-module-error *ngIf="status.failedErrorShown" class="position-absolute w-100 h-100 bg-white p-4"
                      [error]="status.error" style="z-index: 2">
        <a appLink="/projects">Go to Projects <i class="fa fa-fw fa-arrow-right"></i></a>
    </app-module-error>

    <div *ngIf="status.resultsShown" class="position-absolute w-100 h-100 d-flex flex-column" style="z-index: 0">
        <div class="module">
            <div class="module-header">
                <!-- Breadcrumbs -->
                <div class="module-breadcrumb-bar mb-1">
                    <app-object-path [object]="object?.parent" [newTab]="true"></app-object-path>
                </div>

                <div class="module-title-bar">
                    <button type="button" class="module-title-bar-back mr-2" [appLink]="returnUrl" *ngIf="returnUrl">
                        <i class="fa fa-fw fa-arrow-left"></i>
                    </button>
                    <h1 class="toolbar-title text-truncate mr-1" draggable="true" (dragstart)="dragStarted($event)">
                        {{ object?.filename }}
                    </h1>

                    <div ngbDropdown class="d-inline-block mr-4" container="body">
                        <a href="#" class="dropdown-no-arrow" ngbDropdownToggle (click)="$event.preventDefault()">
                            <i class="fas fa-chevron-down fa-fw text-icon"></i>
                        </a>
                        <div ngbDropdownMenu>
                            <app-object-menu *ngIf="object" [object]="object" [forEditing]="true"
                                             [showOpen]="false" [showDelete]="false"
                                             (objectRefresh)="requestRefresh()">
                            </app-object-menu>
                        </div>
                    </div>

                    <div class="btn-group" role="group">
                        <div ngbDropdown class="d-inline-block" #dropdown placement="bottom-right" container="body">
                            <button class="btn btn-secondary" [id]="id + '-filters-dropdown'" ngbDropdownToggle>
                                <i class="fa fa-fw fa-filter"></i>
                            </button>
                            <div ngbDropdownMenu [attr.aria-labelledby]="id + '-filters-dropdown'"
                                 [style.width]="'220px'"
                                 class="dropdown-body dropdown-menu dropdown-menu-right">
                                <div class="mb-2">
                                    <button *ngIf="!entityTypeVisibilityChanged"
                                            class="btn btn-outline-secondary btn-block"
                                            (click)="setAllEntityTypesVisibility(false)">
                                        Hide All
                                    </button>
                                    <button *ngIf="entityTypeVisibilityChanged"
                                            class="btn btn-outline-secondary btn-block"
                                            (click)="setAllEntityTypesVisibility(true)">
                                        Show All
                                    </button>
                                </div>

                                <div class="mt-2">
                                    <button class="btn btn-secondary btn-block" (click)="closeFilterPopup()">Done
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="module-body flex-fill overflow-auto space-cards">
                    <ngb-accordion #acc="ngbAccordion" activeIds="ngb-panel-0">
                        <ngb-panel *ngFor="let doc of biocData" [title]="doc.pmid">
                            <ng-template ngbPanelContent>
                                <app-bioc-infons [data]="doc.infons"></app-bioc-infons>
                                <div class="passages">
                                    <div *ngFor="let passage of doc.passages" [ngClass]="passage.infons.type">
                                        <app-bioc-infons [data]="passage.infons"></app-bioc-infons>
                                        {{passage.offset}}
                                        <app-bioc-annotated-text
                                                [text]="passage.text"
                                                [annotations]="passage.annotations"
                                                [offset]="passage.offset"
                                        >
                                        </app-bioc-annotated-text>
                                        <div class="sentences">
                                            <div *ngFor="let sentence of passage.sentences">
                                                {{sentence}}
                                            </div>
                                        </div>
                                        <div class="relations">
                                            <div *ngFor="let relation of passage.relations">
                                                {{relation}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {{doc.relations}}
                                {{doc.created}}
                                {{doc.created.$date | date}}
                                <div class="accessions">
                                    <div *ngFor="let accession of doc.accessions">
                                        {{accession}}
                                    </div>
                                </div>
                                {{doc.journal}}
                                <div class="authors">
                                    <div *ngFor="let author of doc.authors">
                                        {{author}}
                                    </div>
                                </div>
                            </ng-template>
                        </ngb-panel>
                    </ngb-accordion>
                </div>
            </div>
        </div>
    </div>
</div>
